<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Monkey Slug Tool</title>

<style>
* { box-sizing: border-box; }

body {
    margin: 0;
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #1e1e2f, #2a2a40);
    color: #fff;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
}

.container {
    width: 95%;
    height: 95vh;
    background: #2e2e45;
    border-radius: 12px;
    padding: 15px;
    display: flex;
    flex-direction: column;
}

.logo {
    text-align: center;
    font-size: 22px;
    font-weight: bold;
    color: gold;
    margin-bottom: 10px;
}

.main {
    flex: 1;
    display: flex;
    gap: 20px;
}

.column {
    flex: 1;
    display: flex;
    flex-direction: column;
}

textarea {
    height: 300px;
    padding: 10px;
    border-radius: 8px;
    border: none;
    font-size: 14px;
    resize: none;
}

button {
    background: gold;
    border: none;
    padding: 8px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    margin-top: 6px;
    transition: 0.3s;
}

button:hover {
    background: orange;
}

button.success {
    background: #28a745 !important;
    color: white !important;
}

.options {
    margin-top: 10px;
    padding: 10px;
    background: #1f1f30;
    border-radius: 8px;
    font-size: 13px;
}

.options input[type="text"],
.options input[type="number"]{
    width: 70px;
    margin-left: 5px;
}

.stats {
    margin-top: 10px;
    padding: 10px;
    background: #1f1f30;
    border-radius: 8px;
    font-size: 13px;
}
</style>
</head>
<body>

<div class="container">
<div class="logo">üêê Kim Ly Slug Tool</div>

<div class="main">

<div class="column">
<textarea id="inputText" placeholder="Nh·∫≠p n·ªôi dung..." oninput="convertText()"></textarea>
<button id="pasteBtn" onclick="pasteText()">üìã Paste</button>

<div class="options">
<label>
<input type="checkbox" id="replaceSpace" checked>
Thay
</label>
<input type="text" id="charA1" value="space">
th√†nh
<input type="text" id="charA2" value="-">
</div>

<div class="options">
<strong>Ki·ªÉu ch·ªØ:</strong><br>
<label><input type="radio" name="caseOption" value="default" checked> M·∫∑c ƒë·ªãnh</label>
<label><input type="radio" name="caseOption" value="lower"> Th∆∞·ªùng</label>
<label><input type="radio" name="caseOption" value="upper"> Hoa</label>
</div>
</div>

<div class="column">
<textarea id="outputText" placeholder="K·∫øt qu·∫£..." onclick="this.select()"></textarea>
<button id="copyBtn" onclick="copyText()">Copy</button>

<div class="options">
<strong>Gi·ªõi h·∫°n:</strong><br>
<label><input type="radio" name="limitOption" value="12"> 12</label>
<label><input type="radio" name="limitOption" value="14" checked> 14</label>
<label><input type="radio" name="limitOption" value="all"> All</label>
<br><br>
<label>
<input type="checkbox" id="customToggle">
Gi·ªØ t√πy ch·ªânh:
</label>
<input type="number" id="customLimit" min="1" placeholder="VD: 15" disabled>
</div>

<div class="stats" id="stats"></div>
</div>

</div>
</div>

<script>
function removeVietnameseTones(str) {
    return str
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "")
        .replace(/ƒë/g, "d")
        .replace(/ƒê/g, "d");
}

function convertText() {
    let input = document.getElementById("inputText").value;

    let inputWords = input.trim() ? input.trim().split(/\s+/).length : 0;
    let inputChars = input.length;

    if (!input) {
        document.getElementById("outputText").value = "";
        document.getElementById("stats").innerHTML = "";
        return;
    }

    let text = removeVietnameseTones(input);

    let caseOption = document.querySelector('input[name="caseOption"]:checked').value;
    if (caseOption === "lower") text = text.toLowerCase();
    if (caseOption === "upper") text = text.toUpperCase();

    text = text.replace(/[^a-zA-Z\s]/g, "");
    let words = text.trim().split(/\s+/);

    let customToggle = document.getElementById("customToggle").checked;
    let customLimit = document.getElementById("customLimit").value;
    let limitOption = document.querySelector('input[name="limitOption"]:checked');

    if (customToggle && customLimit) {
        words = words.slice(0, parseInt(customLimit));
    } else if (!customToggle && limitOption && limitOption.value !== "all") {
        words = words.slice(0, parseInt(limitOption.value));
    }

    let result;

    if (document.getElementById("replaceSpace").checked) {
        let A2 = document.getElementById("charA2").value || "-";
        result = words.join(A2);
    } else {
        result = words.join(" ");
    }

    document.getElementById("outputText").value = result;

    document.getElementById("stats").innerHTML =
        "üì• ƒê·∫ßu v√†o: " + inputWords + " t·ª´ | " + inputChars + " k√Ω t·ª±" +
        "<br>üì§ ƒê·∫ßu ra: " + words.length + " t·ª´ | " + result.length + " k√Ω t·ª±";
}

function lockButton(btn, originalText, successText) {
    btn.classList.add("success");
    btn.disabled = true;
    btn.innerText = successText;

    setTimeout(() => {
        btn.classList.remove("success");
        btn.disabled = false;
        btn.innerText = originalText;
    }, 3000);
}

async function copyText() {
    let btn = document.getElementById("copyBtn");
    if (btn.disabled) return;

    let text = document.getElementById("outputText").value;

    try {
        await navigator.clipboard.writeText(text);
        lockButton(btn, "Copy", "ƒê√£ copy");
    } catch (err) {
        console.log("Copy failed");
    }
}

async function pasteText() {
    let btn = document.getElementById("pasteBtn");
    if (btn.disabled) return;

    try {
        const text = await navigator.clipboard.readText();
        document.getElementById("inputText").value = text;
        convertText();
        lockButton(btn, "üìã Paste", "ƒê√£ paste");
    } catch (err) {
        alert("Tr√¨nh duy·ªát ch∆∞a c·∫•p quy·ªÅn clipboard.");
    }
}

document.querySelectorAll('input').forEach(el => {
    el.addEventListener("input", convertText);
    el.addEventListener("change", convertText);
});
</script>

</body>
</html>
