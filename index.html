<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Monkey Slug Tool</title>

<style>
* { box-sizing: border-box; }

body {
    margin: 0;
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #1e1e2f, #2a2a40);
    color: #fff;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
}

.container {
    width: 95%;
    height: 95vh;
    background: #2e2e45;
    border-radius: 12px;
    padding: 15px;
    display: flex;
    flex-direction: column;
}

.logo {
    text-align: center;
    font-size: 22px;
    font-weight: bold;
    color: gold;
    margin-bottom: 10px;
}

.main {
    flex: 1;
    display: flex;
    gap: 20px;
}

.column {
    flex: 1;
    display: flex;
    flex-direction: column;
}

textarea {
    height: 300px;
    padding: 10px;
    border-radius: 8px;
    border: none;
    font-size: 14px;
    resize: none;
}

button {
    background: gold;
    border: none;
    padding: 8px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    margin-top: 6px;
}

button:hover {
    background: orange;
}

.options {
    margin-top: 10px;
    padding: 10px;
    background: #1f1f30;
    border-radius: 8px;
    font-size: 13px;
}

.options input[type="text"],
.options input[type="number"]{
    width: 70px;
    margin-left: 5px;
}

.stats {
    margin-top: 10px;
    padding: 10px;
    background: #1f1f30;
    border-radius: 8px;
    font-size: 13px;
}
</style>
</head>
<body>

<div class="container">
<div class="logo">üêí ƒê√¥ng Slug Tool</div>

<div class="main">

<!-- C·ªòT TR√ÅI -->
<div class="column">
<textarea id="inputText" placeholder="Nh·∫≠p n·ªôi dung..." oninput="convertText()"></textarea>
<button onclick="pasteText()">üìã Paste</button>

<div class="options">
<label>
<input type="checkbox" id="replaceSpace" checked>
Thay 
</label>
<input type="text" id="charA1" value="space">
th√†nh
<input type="text" id="charA2" value="-">
</div>

<div class="options">
<strong>Ki·ªÉu ch·ªØ:</strong><br>
<label><input type="radio" name="caseOption" value="default" checked> M·∫∑c ƒë·ªãnh</label>
<label><input type="radio" name="caseOption" value="lower"> Th∆∞·ªùng</label>
<label><input type="radio" name="caseOption" value="upper"> Hoa</label>
</div>
</div>

<!-- C·ªòT PH·∫¢I -->
<div class="column">
<textarea id="outputText" placeholder="K·∫øt qu·∫£..." onclick="this.select()"></textarea>
<button onclick="copyText()">Copy</button>

<div class="options">
<strong>Gi·ªõi h·∫°n:</strong><br>
<label><input type="radio" name="limitOption" value="12"> 12</label>
<label><input type="radio" name="limitOption" value="14" checked> 14</label>
<label><input type="radio" name="limitOption" value="all"> All</label>
<br><br>
<label>
<input type="checkbox" id="customToggle">
Gi·ªØ t√πy ch·ªânh:
</label>
<input type="number" id="customLimit" min="1" placeholder="VD: 15" disabled>
</div>

<div class="stats" id="stats"></div>
</div>

</div>
</div>

<script>
function removeVietnameseTones(str) {
    return str
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "")
        .replace(/ƒë/g, "d")
        .replace(/ƒê/g, "d");
}

function convertText() {
    let input = document.getElementById("inputText").value;

    let inputWords = input.trim() ? input.trim().split(/\s+/).length : 0;
    let inputChars = input.length;

    if (!input) {
        document.getElementById("outputText").value = "";
        document.getElementById("stats").innerHTML = "";
        return;
    }

    let text = removeVietnameseTones(input);

    let caseOption = document.querySelector('input[name="caseOption"]:checked').value;
    if (caseOption === "lower") text = text.toLowerCase();
    if (caseOption === "upper") text = text.toUpperCase();

    text = text.replace(/[^a-zA-Z\s]/g, "");

    let words = text.trim().split(/\s+/);

    // GI·ªöI H·∫†N
    let customToggle = document.getElementById("customToggle").checked;
    let customLimit = document.getElementById("customLimit").value;
    let limitOption = document.querySelector('input[name="limitOption"]:checked').value;

    if (customToggle && customLimit) {
        words = words.slice(0, parseInt(customLimit));
    } else if (!customToggle && limitOption !== "all") {
        words = words.slice(0, parseInt(limitOption));
    }

    let result;

    if (document.getElementById("replaceSpace").checked) {

        let A1Input = document.getElementById("charA1");
        let A2 = document.getElementById("charA2").value || "-";

        let A1 = A1Input.value;

        if (A1 === " ") {
            A1Input.value = "space";
            A1 = " ";
        }

        if (A1.toLowerCase() === "space") A1 = " ";

        let joined = words.join(" ");
        let regex = new RegExp(A1.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), "g");
        result = joined.replace(regex, A2);

    } else {
        result = words.join(" ");
    }

    document.getElementById("outputText").value = result;

    let A2 = document.getElementById("charA2").value || "-";
    let outputWords = result ? result.split(A2).filter(w => w !== "").length : 0;
    let outputChars = result.length;

    document.getElementById("stats").innerHTML =
        "üì• ƒê·∫ßu v√†o: " + inputWords + " t·ª´ | " + inputChars + " k√Ω t·ª±" +
        "<br>üì§ ƒê·∫ßu ra: " + outputWords + " t·ª´ | " + outputChars + " k√Ω t·ª±";
}

// T·∫Øt radio khi b·∫≠t custom
document.getElementById("customToggle").addEventListener("change", function(){
    let radios = document.querySelectorAll('input[name="limitOption"]');
    let customInput = document.getElementById("customLimit");

    if(this.checked){
        radios.forEach(r => r.checked = false);
        customInput.disabled = false;
    } else {
        radios[1].checked = true; // m·∫∑c ƒë·ªãnh 14
        customInput.disabled = true;
    }

    convertText();
});

// N·∫øu ch·ªçn radio th√¨ t·∫Øt custom
document.querySelectorAll('input[name="limitOption"]').forEach(r=>{
    r.addEventListener("change", function(){
        document.getElementById("customToggle").checked = false;
        document.getElementById("customLimit").disabled = true;
        convertText();
    });
});

async function copyText() {
    let text = document.getElementById("outputText").value;
    try {
        await navigator.clipboard.writeText(text);
    } catch (err) {
        console.log("Copy failed");
    }
}



async function pasteText() {
    try {
        const text = await navigator.clipboard.readText();
        document.getElementById("inputText").value = text;
        convertText();
    } catch (err) {
        alert("Tr√¨nh duy·ªát ch∆∞a c·∫•p quy·ªÅn clipboard.");
    }
}

document.querySelectorAll('input').forEach(el => {
    el.addEventListener("input", convertText);
    el.addEventListener("change", convertText);
});
</script>

</body>
</html>